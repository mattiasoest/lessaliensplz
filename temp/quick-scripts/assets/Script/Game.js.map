{"version":3,"sources":["Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/Script","sourcesContent":["import InvincibleEffect from \"./InvincibleEffect\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class Game extends cc.Component {\n    // CONSTANTS\n    private readonly ASTEROID_SPAWN_RATE: number = 1.5;\n    private readonly COIN_SPAWN_RATE: number = 1.55;\n    private readonly AMMO_SPAWN_RATE: number = 7.1;\n    private readonly AMMO_PER_BOX: number = 8;\n    private readonly ENEMY_SPAWN_RATE: number = 8;\n    private readonly INVINCIBLE_DURATION: number = 5;\n    \n    public readonly GAME_STATE = { PLAY : 0, MENU : 1 }\n\n    currentState = this.GAME_STATE.MENU;\n\n    // NORMAL INSTANCE VARIABLES\n    private currentAmmo: number = this.AMMO_PER_BOX;\n    private coinScore: number = 0;\n    private coinSound: cc.AudioSource = null;\n    private time: number = 0;\n    private gravity: number = -70;\n    private cvs: cc.Node = null;\n    private scheduler : cc.Scheduler = null;\n    private invincibleParticleObject: InvincibleEffect = null;\n    private isAlive = true;\n    private isBoundHit = false;\n    private increaseOpacity = true;\n    private isBoundAnimationPlaying: boolean = false;\n    private menuMusicId = -1;\n    private gameMusicId = -1;\n    player: cc.Node = null;\n    \n\n    @property(cc.Node)\n    menu: cc.Node = null;\n\n    @property(cc.Label)\n    scoreLabel: cc.Label = null;\n\n    @property(cc.Label)\n    timeLabel: cc.Label = null;\n\n    @property(cc.Label)\n    ammoLabel: cc.Label = null;\n\n    @property(cc.Prefab)\n    coin: cc.Prefab = null;\n\n    @property(cc.Prefab)\n    playerFab: cc.Prefab = null;\n\n    @property(cc.Prefab)\n    playerLaser: cc.Prefab = null;\n\n    @property(cc.Prefab)\n    redLaser: cc.Prefab = null;\n\n    @property(cc.Prefab)\n    asteroid: cc.Prefab = null;\n\n    @property(cc.Prefab)\n    bigEnemy: cc.Prefab = null;\n\n    @property(cc.Prefab)\n    medEnemy: cc.Prefab = null;\n\n    @property(cc.Prefab)\n    smallEnemy: cc.Prefab = null;\n\n    @property(cc.Prefab)\n    playerAmmo: cc.Prefab = null;\n\n    @property(cc.AudioClip)\n    noAmmoSound: cc.AudioClip = null;\n\n    @property(cc.AudioClip)\n    ammoPickupSound: cc.AudioClip = null;\n\n    @property(cc.AudioClip)\n    rockExpSound: cc.AudioClip = null;\n\n    @property(cc.AudioClip)\n    menuMusic: cc.AudioClip = null;\n\n    @property(cc.AudioClip)\n    gameplayMusic: cc.AudioClip = null;\n\n    @property(cc.Node)\n    upperBound: cc.Node = null;\n\n\n    onLoad () {\n        this.cvs = cc.find(\"Canvas\");\n        // Setup physics engine.\n        let physicsManager = cc.director.getPhysicsManager();\n        physicsManager.enabled = true;\n        physicsManager.gravity = cc.v2(0, this.gravity);\n        this.enableLabels(false);\n        this.coinSound = this.getComponent(cc.AudioSource);\n        this.scheduler = cc.director.getScheduler();\n        this.menu.active = true;\n        this.upperBound.active = false;\n        this.startBgMusic();\n    }\n\n    start () {\n\n    }\n\n    startBgMusic() {\n        this.menuMusicId = cc.audioEngine.playMusic(this.menuMusic, true);\n        cc.audioEngine.setMusicVolume(0.55);\n    }\n\n    update (dt) {\n        switch (this.currentState) {\n            case this.GAME_STATE.PLAY:\n                this.checkTopBoundAnimation(dt);\n                this.time+= dt;\n                this.timeLabel.string = \"Time: \" + this.parseTime(this.time); \n                break;\n            case this.GAME_STATE.MENU:\n                break;\n        }\n    }\n\n    startGame() {\n        this.createPlayer();\n        this.menu.active = false;\n        this.setupItemAutoGeneration();\n\n        this.enableLabels(true);\n        this.scoreLabel.string = \"Coins: \" + this.coinScore;\n        this.ammoLabel.string = \"Ammo: \" + this.currentAmmo;\n\n        this.setGameState(this.GAME_STATE.PLAY);\n        this.upperBound.y = this.upperBound.height / 2 + this.getPlayerUpperBound() + this.player.height / 2;\n        this.upperBound.active = true;\n        this.upperBound.opacity = 0;\n    }\n\n    setGameState(state: number) {\n        switch (state) {\n            case this.GAME_STATE.MENU:\n                this.menuMusicId = cc.audioEngine.playMusic(this.menuMusic, true);\n                this.currentState = state;\n                break;\n            case this.GAME_STATE.PLAY:\n                this.gameMusicId = cc.audioEngine.playMusic(this.gameplayMusic, true);\n                this.currentState = state;\n                break;\n            default: \n                throw new Error(\"Invalid game state: \" + state);\n        }\n\n    }\n\n    resetGame() {\n        this.setGameState(this.GAME_STATE.MENU);\n        this.playPlayerExplosionAnimation();\n        this.player.getComponent(cc.RigidBody).enabledContactListener = false;\n        this.isAlive = false;\n        this.coinScore = 0;\n        this.currentAmmo = this.AMMO_PER_BOX;\n        this.endRandomGeneration();\n        this.isBoundAnimationPlaying = false;\n        this.upperBound.opacity = 0;\n\n        // Let animation finish etc..\n        setTimeout(() => {\n            this.node.destroyAllChildren();\n            this.enableLabels(false);\n            this.time = 0;\n            this.menu.active = true;\n            }, 1250);\n        }\n\n    hitBound() {        \n        this.isBoundHit = true;    \n    }\n\n    checkTopBoundAnimation(dt) {\n        if (this.isBoundHit) {\n            this.isBoundHit = false;\n            if (!this.isBoundAnimationPlaying) {\n                this.isBoundAnimationPlaying = true;\n            }\n        }\n        else if (this.isBoundAnimationPlaying) {\n            if (this.increaseOpacity && this.upperBound.opacity < 220) {\n                this.upperBound.opacity += 700 * dt;\n            }\n            else if(this.upperBound.opacity > 0) {\n                this.increaseOpacity = false;\n                this.upperBound.opacity -= 700 * dt;\n            }\n            else {\n                this.upperBound.opacity = 0;\n                this.increaseOpacity = true;\n                this.isBoundAnimationPlaying = false;\n            }\n        }\n    }\n\n    enableLabels(isEnabled: boolean) {\n        this.scoreLabel.enabled = isEnabled;\n        this.timeLabel.enabled = isEnabled;\n        this.ammoLabel.enabled = isEnabled;\n    }\n\n    playRockExplosion() {\n        cc.audioEngine.play(this.rockExpSound, false, 0.8);\n    }\n\n    playPlayerExplosionAnimation() {\n        this.player.getComponent(cc.Animation).play(\"Explosion\");\n    }\n\n    generateRandomPos() {\n        let randomX = Math.random() * this.cvs.width / 2;\n        // set sign value\n        randomX *= this.generateRandomSign();\n        return cc.v2(randomX, this.cvs.height * 0.62);\n    }\n\n    generateRandomSign() {\n        return Math.random() <= 0.5 ? -1 : 1;\n    }\n\n    updateCoinScore() {\n        this.coinScore++;\n        this.coinSound.play();\n        if (this.coinScore >= 5) {\n            this.coinScore = 0;\n            this.invincibleParticleObject.startParticleEffect();\n            this.player.getComponent(\"PlayerControl\").makeInvincible();\n        }\n        this.scoreLabel.string = \"Coins: \" + this.coinScore;\n    }\n\n    addAmmo() {\n        this.currentAmmo += this.AMMO_PER_BOX;\n        cc.audioEngine.play(this.ammoPickupSound, false, 1);\n        this.ammoLabel.string = \"Ammo: \" + this.currentAmmo;\n    }\n\n    parseTime(toBeParsed: number) {\n        return Number(Math.round(toBeParsed * 100) / 100).toFixed(2);\n    }\n\n    // ========== DYNAMICALLY OBJECT CREATORS ==========\n\n    createPlayer() {\n        this.player = cc.instantiate(this.playerFab);\n        this.node.addChild(this.player);\n        // Push reference of the game object\n        this.player.getComponent('PlayerControl').game = this;\n        this.invincibleParticleObject = this.player.getChildByName(\"Particles\").getComponent(\"InvincibleEffect\");\n        this.invincibleParticleObject.setDuration(this.INVINCIBLE_DURATION);\n        this.isAlive = true;\n    }\n\n    spawnCoin() {\n        const newCoin = cc.instantiate(this.coin);\n        this.node.addChild(newCoin);\n        newCoin.setPosition(this.generateRandomPos());\n\n        // Leave a reference to the game object.\n        newCoin.getComponent('Coin').game = this;\n    }\n\n    spawnBlueLaser() {\n        if (this.currentAmmo <= 0) {\n            cc.audioEngine.play(this.noAmmoSound, false, 1);\n            return;\n        }\n        this.currentAmmo--;\n        this.ammoLabel.string = \"Ammo: \" + this.currentAmmo;\n        const newLaser = cc.instantiate(this.playerLaser);\n        newLaser.setPosition(this.player.x, this.player.y + this.player.height * 0.35);\n\n        // Leave a reference to the game object.\n        const laserObject = newLaser.getComponent('LaserBlue');\n        laserObject.game = this;\n\n        const body = newLaser.getComponent(cc.RigidBody);\n        body.linearVelocity = cc.v2(0, 450);\n        this.node.addChild(newLaser);\n        laserObject.playLaserSound();\n    }\n\n    spawnEnemyLaser(xOffset: number, node: cc.Node, velocityVector: cc.Vec2) {\n        const newLaser = cc.instantiate(this.redLaser);\n        // Relative to the current node. So center it.\n        newLaser.setPosition(node.x + xOffset, node.y -node.height / 2);\n        const body = newLaser.getComponent(cc.RigidBody);\n        body.linearVelocity = velocityVector;\n        // Set the bullets parent to the game object \n        // So they survive even if the enemy is killed\n        // Gets destroyed later by its own laser logic\n        this.node.addChild(newLaser);\n        const laserObject = newLaser.getComponent('LaserRed');\n        // Game from the superclass.\n        laserObject.game = this;\n    }\n\n    spawnAsteroid() {\n        const newAsteroid = cc.instantiate(this.asteroid);\n        this.node.addChild(newAsteroid);\n        let pos = this.generateRandomPos();\n        pos.x *= 0.77;\n        newAsteroid.setPosition(pos);\n\n        const body = newAsteroid.getComponent(cc.RigidBody)\n        const yVel = -50 + Math.random() * -220;\n        let xVel = (Math.random() + 1) * 20  * this.generateRandomSign();\n        body.linearVelocity = cc.v2(xVel , yVel);\n        // Leave a reference to the game object.\n        newAsteroid.getComponent('Asteroid').game = this;\n    }\n\n    spawnAmmo() {\n        const newAmmoBox = cc.instantiate(this.playerAmmo);\n        this.node.addChild(newAmmoBox);\n        newAmmoBox.setPosition(this.generateRandomPos());\n        const body = newAmmoBox.getComponent(cc.RigidBody);\n        body.linearVelocity = cc.v2(0, -95);\n        // Leave a reference to the game object.\n        newAmmoBox.getComponent('Ammo').game = this;\n    }\n\n    spawnRandomEnemy() {\n        let newEnemy = null;\n        const random = Math.random();\n        if (random < 0.33) {\n            newEnemy = cc.instantiate(this.smallEnemy);\n            newEnemy.getComponent('EnemySmall').game = this;\n        }\n        else if (random <= 0.67) {\n            newEnemy = cc.instantiate(this.medEnemy);\n            newEnemy.getComponent('EnemyMedium').game = this;\n        }\n        else {\n            newEnemy = cc.instantiate(this.bigEnemy);\n            newEnemy.getComponent('EnemyBig').game = this;\n        }\n\n        this.node.addChild(newEnemy);\n        newEnemy.setPosition(this.generateRandomPos());\n    }\n\n    getInvincibleDuration() {\n        return this.INVINCIBLE_DURATION;\n    }\n\n    getPlayerUpperBound() {\n        return -this.cvs.height * 0.125;\n    }\n\n\n    isPlayerAlive() {\n        return this.isAlive;\n    }\n\n\n    setupItemAutoGeneration() {\n        this.setCoinScheduler();\n        this.setAsteroidScheduler();\n        this.setAmmoScheduler();\n        this.setEnemyScheduler();\n\n        // Spawn 1 set of each item without delay\n        this.spawnRandomEnemy();\n        this.spawnAmmo();\n        this.spawnAsteroid();\n        this.spawnCoin();\n    }\n\n    endRandomGeneration() {\n        this.scheduler.unschedule(this.spawnCoin, this);\n        this.scheduler.unschedule(this.spawnAsteroid, this);\n        this.scheduler.unschedule(this.spawnAmmo, this);\n        this.scheduler.unschedule(this.spawnRandomEnemy, this);\n    }\n\n    // ========== SCHEDULERS ==========\n    setCoinScheduler() {\n        this.scheduler.schedule(this.spawnCoin, this, this.COIN_SPAWN_RATE, false);\n    }\n\n    setAsteroidScheduler() {\n        this.scheduler.schedule(this.spawnAsteroid, this, this.ASTEROID_SPAWN_RATE, false);\n    }\n\n    setAmmoScheduler() {\n        this.scheduler.schedule(this.spawnAmmo, this, this.AMMO_SPAWN_RATE, false);\n    }\n\n    setEnemyScheduler() {\n        this.scheduler.schedule(this.spawnRandomEnemy, this, this.ENEMY_SPAWN_RATE, false);\n    }\n}\n"]}